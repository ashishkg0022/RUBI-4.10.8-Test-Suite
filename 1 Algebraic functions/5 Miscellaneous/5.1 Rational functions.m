(* ::Package:: *)

(* ::Title:: *)
(*Rational Function Integration Problems*)


(* ::Section::Closed:: *)
(*Integrands of the form u (a+b x+c x^2+d x^3)^p*)


{1/(2*Sqrt[3]*b^(3/2) - 9*b*x + 9*x^3), x, 3, 1/(3*Sqrt[3]*Sqrt[b]*(Sqrt[3]*Sqrt[b] - 3*x)) - Log[Sqrt[b] - Sqrt[3]*x]/(27*b) + Log[2*Sqrt[b] + Sqrt[3]*x]/(27*b)}


{(a^3 + 3*a^2*b*x + 3*a*b^2*x^2 + b^3*x^3)^p, x, 2, ((a + b*x)*(a^3 + 3*a^2*b*x + 3*a*b^2*x^2 + b^3*x^3)^p)/(b*(1 + 3*p))}

{(a^3 + 3*a^2*b*x + 3*a*b^2*x^2 + b^3*x^3)^3, x, 2, (a + b*x)^10/(10*b)}
{(a^3 + 3*a^2*b*x + 3*a*b^2*x^2 + b^3*x^3)^2, x, 2, (a + b*x)^7/(7*b)}
{(a^3 + 3*a^2*b*x + 3*a*b^2*x^2 + b^3*x^3)^1, x, 1, a^3*x + (3/2)*a^2*b*x^2 + a*b^2*x^3 + (b^3*x^4)/4}
{1/(a^3 + 3*a^2*b*x + 3*a*b^2*x^2 + b^3*x^3)^1, x, 2, -(1/(2*b*(a + b*x)^2))}
{1/(a^3 + 3*a^2*b*x + 3*a*b^2*x^2 + b^3*x^3)^2, x, 2, -(1/(5*b*(a + b*x)^5))}
{1/(a^3 + 3*a^2*b*x + 3*a*b^2*x^2 + b^3*x^3)^3, x, 2, -(1/(8*b*(a + b*x)^8))}


{(3*a*b + 3*b^2*x + 3*b*c*x^2 + c^2*x^3)^3, x, 3, -((b^3*(b^2 - 3*a*c)^3*x)/c^3) + (3*b^2*(b^2 - 3*a*c)^2*(b + c*x)^4)/(4*c^4) - (3*b*(b^2 - 3*a*c)*(b + c*x)^7)/(7*c^4) + (b + c*x)^10/(10*c^4)}
{(3*a*b + 3*b^2*x + 3*b*c*x^2 + c^2*x^3)^2, x, 3, (b^2*(b^2 - 3*a*c)^2*x)/c^2 - (b*(b^2 - 3*a*c)*(b + c*x)^4)/(2*c^3) + (b + c*x)^7/(7*c^3)}
{(3*a*b + 3*b^2*x + 3*b*c*x^2 + c^2*x^3)^1, x, 1, 3*a*b*x + (3*b^2*x^2)/2 + b*c*x^3 + (c^2*x^4)/4}
{1/(3*a*b + 3*b^2*x + 3*b*c*x^2 + c^2*x^3)^1, x, 8, -(ArcTan[(b^(1/3) + (2*(b + c*x))/(b^2 - 3*a*c)^(1/3))/(Sqrt[3]*b^(1/3))]/(Sqrt[3]*b^(2/3)*(b^2 - 3*a*c)^(2/3))) + Log[-b + b^(1/3)*(b^2 - 3*a*c)^(1/3) - c*x]/(3*b^(2/3)*(b^2 - 3*a*c)^(2/3)) - Log[b^(2/3)*(b^2 - 3*a*c)^(2/3) + b^(1/3)*(b^2 - 3*a*c)^(1/3)*(b + c*x) + (b + c*x)^2]/(6*b^(2/3)*(b^2 - 3*a*c)^(2/3))}
{1/(3*a*b + 3*b^2*x + 3*b*c*x^2 + c^2*x^3)^2, x, 9, (c*(b + c*x))/(3*b*(b^2 - 3*a*c)*(b*(b^2 - 3*a*c) - (b + c*x)^3)) + (2*c*ArcTan[(b^(1/3) + (2*(b + c*x))/(b^2 - 3*a*c)^(1/3))/(Sqrt[3]*b^(1/3))])/(3*Sqrt[3]*b^(5/3)*(b^2 - 3*a*c)^(5/3)) - (2*c*Log[-b + b^(1/3)*(b^2 - 3*a*c)^(1/3) - c*x])/(9*b^(5/3)*(b^2 - 3*a*c)^(5/3)) + (c*Log[b^(2/3)*(b^2 - 3*a*c)^(2/3) + b^(1/3)*(b^2 - 3*a*c)^(1/3)*(b + c*x) + (b + c*x)^2])/(9*b^(5/3)*(b^2 - 3*a*c)^(5/3))}
{1/(3*a*b + 3*b^2*x + 3*b*c*x^2 + c^2*x^3)^3, x, 10, -((c^2*(b + c*x))/(6*b*(b^2 - 3*a*c)*(b*(b^2 - 3*a*c) - (b + c*x)^3)^2)) - (5*c^2*(b + c*x))/(18*b^2*(b^2 - 3*a*c)^2*(b*(b^2 - 3*a*c) - (b + c*x)^3)) - (5*c^2*ArcTan[(b^(1/3) + (2*(b + c*x))/(b^2 - 3*a*c)^(1/3))/(Sqrt[3]*b^(1/3))])/(9*Sqrt[3]*b^(8/3)*(b^2 - 3*a*c)^(8/3)) + (5*c^2*Log[-b + b^(1/3)*(b^2 - 3*a*c)^(1/3) - c*x])/(27*b^(8/3)*(b^2 - 3*a*c)^(8/3)) - (5*c^2*Log[b^(2/3)*(b^2 - 3*a*c)^(2/3) + b^(1/3)*(b^2 - 3*a*c)^(1/3)*(b + c*x) + (b + c*x)^2])/(54*b^(8/3)*(b^2 - 3*a*c)^(8/3))}


{(a c e+(b c e+a d e+a c f) x+(b d e+b c f+a d f) x^2+b d f x^3)^3, x, 2, a^3*c^3*e^3*x + (3/2)*a^2*c^2*e^2*(b*c*e + a*d*e + a*c*f)*x^2 + a*c*e*(b^2*c^2*e^2 + 3*a*b*c*e*(d*e + c*f) + a^2*(d^2*e^2 + 3*c*d*e*f + c^2*f^2))*x^3 + (1/4)*(b^3*c^3*e^3 + 9*a*b^2*c^2*e^2*(d*e + c*f) + 9*a^2*b*c*e*(d^2*e^2 + 3*c*d*e*f + c^2*f^2) + a^3*(d^3*e^3 + 9*c*d^2*e^2*f + 9*c^2*d*e*f^2 + c^3*f^3))*x^4 + (3/5)*(b^3*c^2*e^2*(d*e + c*f) + 3*a*b^2*c*e*(d^2*e^2 + 3*c*d*e*f + c^2*f^2) + a^3*d*f*(d^2*e^2 + 3*c*d*e*f + c^2*f^2) + a^2*b*(d^3*e^3 + 9*c*d^2*e^2*f + 9*c^2*d*e*f^2 + c^3*f^3))*x^5 + (1/2)*(a^3*d^2*f^2*(d*e + c*f) + b^3*c*e*(d^2*e^2 + 3*c*d*e*f + c^2*f^2) + 3*a^2*b*d*f*(d^2*e^2 + 3*c*d*e*f + c^2*f^2) + a*b^2*(d^3*e^3 + 9*c*d^2*e^2*f + 9*c^2*d*e*f^2 + c^3*f^3))*x^6 + (1/7)*(a^3*d^3*f^3 + 9*a^2*b*d^2*f^2*(d*e + c*f) + 9*a*b^2*d*f*(d^2*e^2 + 3*c*d*e*f + c^2*f^2) + b^3*(d^3*e^3 + 9*c*d^2*e^2*f + 9*c^2*d*e*f^2 + c^3*f^3))*x^7 + (3/8)*b*d*f*(a^2*d^2*f^2 + 3*a*b*d*f*(d*e + c*f) + b^2*(d^2*e^2 + 3*c*d*e*f + c^2*f^2))*x^8 + (1/3)*b^2*d^2*f^2*(b*d*e + b*c*f + a*d*f)*x^9 + (1/10)*b^3*d^3*f^3*x^10}
{(a c e+(b c e+a d e+a c f) x+(b d e+b c f+a d f) x^2+b d f x^3)^2, x, 2, a^2*c^2*e^2*x + a*c*e*(b*c*e + a*d*e + a*c*f)*x^2 + (1/3)*(b^2*c^2*e^2 + 4*a*b*c*e*(d*e + c*f) + a^2*(d^2*e^2 + 4*c*d*e*f + c^2*f^2))*x^3 + (1/2)*(b^2*c*e*(d*e + c*f) + a^2*d*f*(d*e + c*f) + a*b*(d^2*e^2 + 4*c*d*e*f + c^2*f^2))*x^4 + (1/5)*(a^2*d^2*f^2 + 4*a*b*d*f*(d*e + c*f) + b^2*(d^2*e^2 + 4*c*d*e*f + c^2*f^2))*x^5 + (1/3)*b*d*f*(b*d*e + b*c*f + a*d*f)*x^6 + (1/7)*b^2*d^2*f^2*x^7}
{(a c e+(b c e+a d e+a c f) x+(b d e+b c f+a d f) x^2+b d f x^3)^1, x, 1, a*c*e*x + (1/2)*(b*c*e + a*d*e + a*c*f)*x^2 + (1/3)*(b*d*e + b*c*f + a*d*f)*x^3 + (1/4)*b*d*f*x^4}
{1/(a c e+(b c e+a d e+a c f) x+(b d e+b c f+a d f) x^2+b d f x^3)^1, x, 3, (b*Log[a + b*x])/((b*c - a*d)*(b*e - a*f)) - (d*Log[c + d*x])/((b*c - a*d)*(d*e - c*f)) + (f*Log[e + f*x])/((b*e - a*f)*(d*e - c*f))}
{1/(a c e+(b c e+a d e+a c f) x+(b d e+b c f+a d f) x^2+b d f x^3)^2, x, 3, -(b^3/((b*c - a*d)^2*(b*e - a*f)^2*(a + b*x))) - d^3/((b*c - a*d)^2*(d*e - c*f)^2*(c + d*x)) - f^3/((b*e - a*f)^2*(d*e - c*f)^2*(e + f*x)) - (2*b^3*(b*d*e + b*c*f - 2*a*d*f)*Log[a + b*x])/((b*c - a*d)^3*(b*e - a*f)^3) + (2*d^3*(b*d*e - 2*b*c*f + a*d*f)*Log[c + d*x])/((b*c - a*d)^3*(d*e - c*f)^3) + (2*f^3*(2*b*d*e - b*c*f - a*d*f)*Log[e + f*x])/((b*e - a*f)^3*(d*e - c*f)^3)}
{1/(a c e+(b c e+a d e+a c f) x+(b d e+b c f+a d f) x^2+b d f x^3)^3, x, 3, -(b^5/(2*(b*c - a*d)^3*(b*e - a*f)^3*(a + b*x)^2)) + (3*b^5*(b*d*e + b*c*f - 2*a*d*f))/((b*c - a*d)^4*(b*e - a*f)^4*(a + b*x)) + d^5/(2*(b*c - a*d)^3*(d*e - c*f)^3*(c + d*x)^2) + (3*d^5*(b*d*e - 2*b*c*f + a*d*f))/((b*c - a*d)^4*(d*e - c*f)^4*(c + d*x)) - f^5/(2*(b*e - a*f)^3*(d*e - c*f)^3*(e + f*x)^2) - (3*f^5*(2*b*d*e - b*c*f - a*d*f))/((b*e - a*f)^4*(d*e - c*f)^4*(e + f*x)) + (3*b^5*(7*a^2*d^2*f^2 - 7*a*b*d*f*(d*e + c*f) + b^2*(2*d^2*e^2 + 3*c*d*e*f + 2*c^2*f^2))*Log[a + b*x])/((b*c - a*d)^5*(b*e - a*f)^5) - (3*d^5*(2*a^2*d^2*f^2 + a*b*d*f*(3*d*e - 7*c*f) + b^2*(2*d^2*e^2 - 7*c*d*e*f + 7*c^2*f^2))*Log[c + d*x])/((b*c - a*d)^5*(d*e - c*f)^5) + (3*f^5*(2*a^2*d^2*f^2 - a*b*d*f*(7*d*e - 3*c*f) + b^2*(7*d^2*e^2 - 7*c*d*e*f + 2*c^2*f^2))*Log[e + f*x])/((b*e - a*f)^5*(d*e - c*f)^5)}


{1/(-1 + 4*x - 4*x^2 + 16*x^3), x, 6, (-(1/10))*ArcTan[2*x] + (1/5)*Log[1 - 4*x] - (1/10)*Log[1 + 4*x^2]}
{1/(1 + x + x^2 + x^3), x, 6, ArcTan[x]/2 + (1/2)*Log[1 + x] - (1/4)*Log[1 + x^2]}


{1/(0 + 0*x + 0*x^2 + d*x^3), x, 2, -(1/(2*d*x^2))}
{1/(0 + 0*x + c*x^2 + d*x^3), x, 3, -(1/(c*x)) - (d*Log[x])/c^2 + (d*Log[c + d*x])/c^2}
{1/(0 + b*x + 0*x^2 + d*x^3), x, 5, Log[x]/b - Log[b + d*x^2]/(2*b)}
{1/(0 + b*x + c*x^2 + d*x^3), x, 8, (c*ArcTanh[(c + 2*d*x)/Sqrt[c^2 - 4*b*d]])/(b*Sqrt[c^2 - 4*b*d]) + Log[x]/b - Log[b + c*x + d*x^2]/(2*b)}

{1/(a + 0*x + 0*x^2 + d*x^3), x, 7, -(ArcTan[(a^(1/3) - 2*d^(1/3)*x)/(Sqrt[3]*a^(1/3))]/(Sqrt[3]*a^(2/3)*d^(1/3))) + Log[a^(1/3) + d^(1/3)*x]/(3*a^(2/3)*d^(1/3)) - Log[a^(2/3) - a^(1/3)*d^(1/3)*x + d^(2/3)*x^2]/(6*a^(2/3)*d^(1/3))}
(* {1/(a + 0*x + c*x^2 + d*x^3), x, 3, -((72*2^(1/3)*d*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(2/3)*Log[2^(2/3)*c^2 - c*(-4*c^3 - 6*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(1/3) + (-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(2/3) - 3*2^(1/3)*d*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(1/3)*x])/((2*(3*I + Sqrt[3])*c^2 + 2^(1/3)*(3*I - Sqrt[3])*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(2/3))*(2*(3*I - Sqrt[3])*c^2 + 2^(1/3)*(3*I + Sqrt[3])*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(2/3)))) - (12*2^(1/3)*Sqrt[3]*d*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(2/3)*Log[(2^(1/3)*c + (-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(1/3))*(2^(1/3)*(I + Sqrt[3])*c + (I - Sqrt[3])*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(1/3)) + 6*I*2^(1/3)*d*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(1/3)*x])/((2*c^2 - 2^(1/3)*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(2/3))*(2*(3*I + Sqrt[3])*c^2 + 2^(1/3)*(3*I - Sqrt[3])*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(2/3))) + (12*2^(1/3)*Sqrt[3]*d*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(2/3)*Log[(2^(1/3)*c + (-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(1/3))*(2^(1/3)*(I - Sqrt[3])*c + (I + Sqrt[3])*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(1/3)) + 6*I*2^(1/3)*d*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(1/3)*x])/((2*c^2 - 2^(1/3)*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(2/3))*(2*(3*I - Sqrt[3])*c^2 + 2^(1/3)*(3*I + Sqrt[3])*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(2/3)))} *)
(* {1/(a + b*x + 0*x^2 + d*x^3), x, 3, -((6*3^(1/6)*d^(1/3)*(3*Sqrt[3]*a*d - Sqrt[d*(4*b^3 + 27*a^2*d)])*Log[2^(2/3)*3^(1/3)*b*d^(1/3) - (9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3) - 2^(1/3)*3^(2/3)*d^(2/3)*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3)*x])/(18*3^(2/3)*a*b*d^(4/3) - 6*3^(1/6)*b*d^(1/3)*Sqrt[d*(4*b^3 + 27*a^2*d)] - 6*2^(2/3)*b^2*d^(2/3)*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3) - 9*6^(1/3)*a*d*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3) + 2^(1/3)*3^(5/6)*Sqrt[d*(4*b^3 + 27*a^2*d)]*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3))) - (12*2^(1/3)*3^(1/6)*d^(1/3)*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3)*Log[2^(2/3)*3^(1/3)*(1 - I*Sqrt[3])*b*d^(1/3) - (1 + I*Sqrt[3])*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3) + 2*2^(1/3)*3^(2/3)*d^(2/3)*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3)*x])/((6*b*d^(1/3) + 2^(1/3)*(27*a*d - 3*Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3))*(2*(3*I + Sqrt[3])*b*d^(1/3) + 2^(1/3)*3^(1/6)*(1 - I*Sqrt[3])*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3))) + (12*2^(1/3)*3^(2/3)*d^(1/3)*(3*Sqrt[3]*a*d - Sqrt[d*(4*b^3 + 27*a^2*d)])*Log[2^(2/3)*3^(1/3)*(1 + I*Sqrt[3])*b*d^(1/3) + I*(I + Sqrt[3])*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3) + 2*2^(1/3)*3^(2/3)*d^(2/3)*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3)*x])/((9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3)*(6*b*d^(1/3) + 2^(1/3)*(27*a*d - 3*Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3))*(2*(3*I - Sqrt[3])*b*d^(1/3) + I*2^(1/3)*3^(1/6)*(I - Sqrt[3])*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3)))} *)
(* {1/(a + b*x + c*x^2 + d*x^3), x, 0, 0} *)


{(0 + 0*x + 0*x^2 + d*x^3)^n, x, 2, (x*(d*x^3)^n)/(1 + 3*n)}
{(0 + 0*x + c*x^2 + d*x^3)^n, x, 3, (x*(c*x^2 + d*x^3)^n*Hypergeometric2F1[-n, 1 + 2*n, 2*(1 + n), -((d*x)/c)])/((1 + (d*x)/c)^n*(1 + 2*n))}
{(0 + b*x + 0*x^2 + d*x^3)^n, x, 3, (x*(b + d*x^2)*(b*x + d*x^3)^n*Hypergeometric2F1[1, (3*(1 + n))/2, (3 + n)/2, -((d*x^2)/b)])/(b*(1 + n)), (x*(b*x + d*x^3)^n*Hypergeometric2F1[-n, (1 + n)/2, (3 + n)/2, -((d*x^2)/b)])/((1 + d*x^2/b)^n*(1 + n))}
{(0 + b*x + c*x^2 + d*x^3)^n, x, 3, (x*(b*x + c*x^2 + d*x^3)^n*AppellF1[1 + n, -n, -n, 2 + n, -((2*d*x)/(c - Sqrt[c^2 - 4*b*d])), -((2*d*x)/(c + Sqrt[c^2 - 4*b*d]))])/((1 + (2*d*x)/(c - Sqrt[c^2 - 4*b*d]))^n*(1 + (2*d*x)/(c + Sqrt[c^2 - 4*b*d]))^n*(1 + n))}

{(a + 0*x + 0*x^2 + d*x^3)^n, x, 2, (x*(a + d*x^3)^(1 + n)*Hypergeometric2F1[1, 4/3 + n, 4/3, -((d*x^3)/a)])/a, (x*(a + d*x^3)^n*Hypergeometric2F1[1/3, -n, 4/3, -((d*x^3)/a)])/(1 + d*x^3/a)^n}
(* {(a + 0*x + c*x^2 + d*x^3)^n, x, 2, (1/(3*d*(1 + n)))*((2^(-1 + (2*n)/3)*(2*c - (2*2^(1/3)*c^2)/(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(1/3) - 2^(2/3)*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(1/3) + 6*d*x)*(a + c*x^2 + d*x^3)^n*AppellF1[1 + n, -n, -n, 2 + n, -((3*d*(c - (2*c^2 + 2^(1/3)*(-2*c^3 - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[a*(4*c^3 + 27*a*d^2)])^(2/3))/(2^(2/3)*(-2*c^3 - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[a*(4*c^3 + 27*a*d^2)])^(1/3)) + 3*d*x))/(-3*d*(c - (2*c^2 + 2^(1/3)*(-2*c^3 - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[a*(4*c^3 + 27*a*d^2)])^(2/3))/(2^(2/3)*(-2*c^3 - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[a*(4*c^3 + 27*a*d^2)])^(1/3))) + 3*d*(c + (2*(1 + I*Sqrt[3])*c^2 + 2^(1/3)*(1 - I*Sqrt[3])*(-2*c^3 - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[a*(4*c^3 + 27*a*d^2)])^(2/3))/(2*2^(2/3)*(-2*c^3 - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[a*(4*c^3 + 27*a*d^2)])^(1/3))))), -((3*d*(c - (2*c^2 + 2^(1/3)*(-2*c^3 - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[a*(4*c^3 + 27*a*d^2)])^(2/3))/(2^(2/3)*(-2*c^3 - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[a*(4*c^3 + 27*a*d^2)])^(1/3)) + 3*d*x))/(-3*d*(c - (2*c^2 + 2^(1/3)*(-2*c^3 - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[a*(4*c^3 + 27*a*d^2)])^(2/3))/(2^(2/3)*(-2*c^3 - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[a*(4*c^3 + 27*a*d^2)])^(1/3))) + 3*d*(c + (2*(1 - I*Sqrt[3])*c^2 + 2^(1/3)*(1 + I*Sqrt[3])*(-2*c^3 - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[a*(4*c^3 + 27*a*d^2)])^(2/3))/(2*2^(2/3)*(-2*c^3 - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[a*(4*c^3 + 27*a*d^2)])^(1/3)))))])/(((I*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(1/3)*(4*c + (2^(1/3)*((2 + 2*I*Sqrt[3])*c^2 + 2^(1/3)*(1 - I*Sqrt[3])*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(2/3)))/(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(1/3) + 12*d*x))/(2*(3*I - Sqrt[3])*c^2 + 2^(1/3)*(3*I + Sqrt[3])*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(2/3)))^n*((I*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(1/3)*(4*c + (2^(1/3)*((2 - 2*I*Sqrt[3])*c^2 + 2^(1/3)*(1 + I*Sqrt[3])*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(2/3)))/(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(1/3) + 12*d*x))/(2*(3*I + Sqrt[3])*c^2 + 2^(1/3)*(3*I - Sqrt[3])*(-2*c^3 - 3*d*(9*a*d - Sqrt[3]*Sqrt[a*(4*c^3 + 27*a*d^2)]))^(2/3)))^n))} *)
(* {(a + b*x + 0*x^2 + d*x^3)^n, x, 2, -((1/(d^(2/3)*(1 + n)))*((2^(-2 + (2*n)/3)*3^(-2 + (17*n)/6)*((2^(1/3)*3^(2/3)*(6*I*(I - Sqrt[3])*b*d^(1/3) - 2^(1/3)*3^(1/6)*(3*I - Sqrt[3])*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3)))/(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3) - 36*d^(2/3)*x)*(a + b*x + d*x^3)^n*AppellF1[1 + n, -n, -n, 2 + n, (3*d*(-((6*(1 + I*Sqrt[3])*b*d - 2^(1/3)*3^(2/3)*(1 - I*Sqrt[3])*d^(2/3)*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3))/(2*2^(2/3)*3^(1/3)*d^(1/3)*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3))) - 3*d*x))/(-(((3/2)^(2/3)*d^(2/3)*(6*(1 + I*Sqrt[3])*b*d - 2^(1/3)*3^(2/3)*(1 - I*Sqrt[3])*d^(2/3)*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3)))/(2*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3))) + ((3/2)^(2/3)*d^(2/3)*(6*(1 - I*Sqrt[3])*b*d - 2^(1/3)*3^(2/3)*(1 + I*Sqrt[3])*d^(2/3)*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3)))/(2*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3))), -((3*d*(-((6*(1 + I*Sqrt[3])*b*d - 2^(1/3)*3^(2/3)*(1 - I*Sqrt[3])*d^(2/3)*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3))/(2*2^(2/3)*3^(1/3)*d^(1/3)*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3))) - 3*d*x))/(((3/2)^(2/3)*d^(2/3)*(6*b*d - 2^(1/3)*3^(2/3)*d^(2/3)*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3)))/(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3) + ((3/2)^(2/3)*d^(2/3)*(6*(1 + I*Sqrt[3])*b*d - 2^(1/3)*3^(2/3)*(1 - I*Sqrt[3])*d^(2/3)*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3)))/(2*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3))))])/((-((I*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3)*((2^(1/3)*3^(2/3)*(6*I*(I + Sqrt[3])*b*d^(1/3) + 2^(1/3)*3^(1/6)*(3*I + Sqrt[3])*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3)))/(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3) - 36*d^(2/3)*x))/(6*b*d^(1/3) + 2^(1/3)*(27*a*d - 3*Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3))))^n*(-(((9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3)*((2^(1/3)*3^(2/3)*(6*b*d^(1/3) - 2^(1/3)*(27*a*d - 3*Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3)))/(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(1/3) - 18*d^(2/3)*x))/(2*I*(3*I - Sqrt[3])*b*d^(1/3) - 2^(1/3)*3^(1/6)*(I - Sqrt[3])*(9*a*d - Sqrt[3]*Sqrt[d*(4*b^3 + 27*a^2*d)])^(2/3))))^n)))} *)
(* {(a + b*x + c*x^2 + d*x^3)^n, x, 2, (1/(3*d*(1 + n)))*((2^(-1 + (2*n)/3)*(2*c - (2^(1/3)*(2*c^2 - 6*b*d + 2^(1/3)*(-2*c^3 + 9*b*c*d - 3*d*(9*a*d - Sqrt[3]*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2]))^(2/3)))/(-2*c^3 + 9*b*c*d - 3*d*(9*a*d - Sqrt[3]*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2]))^(1/3) + 6*d*x)*(a + b*x + c*x^2 + d*x^3)^n*AppellF1[1 + n, -n, -n, 2 + n, -((3*d*(c - (2*c^2 - 6*b*d + 2^(1/3)*(-2*c^3 + 9*b*c*d - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2])^(2/3))/(2^(2/3)*(-2*c^3 + 9*b*c*d - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2])^(1/3)) + 3*d*x))/(-3*d*(c - (2*c^2 - 6*b*d + 2^(1/3)*(-2*c^3 + 9*b*c*d - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2])^(2/3))/(2^(2/3)*(-2*c^3 + 9*b*c*d - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2])^(1/3))) + 3*d*(c + (2*(1 - I*Sqrt[3])*c^2 - 6*(1 - I*Sqrt[3])*b*d + I*2^(1/3)*(-I + Sqrt[3])*(-2*c^3 + 9*b*c*d - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2])^(2/3))/(2*2^(2/3)*(-2*c^3 + 9*b*c*d - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2])^(1/3))))), -((3*d*(c - (2*c^2 - 6*b*d + 2^(1/3)*(-2*c^3 + 9*b*c*d - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2])^(2/3))/(2^(2/3)*(-2*c^3 + 9*b*c*d - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2])^(1/3)) + 3*d*x))/(-3*d*(c - (2*c^2 - 6*b*d + 2^(1/3)*(-2*c^3 + 9*b*c*d - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2])^(2/3))/(2^(2/3)*(-2*c^3 + 9*b*c*d - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2])^(1/3))) + 3*d*(c + (2*(1 + I*Sqrt[3])*c^2 - 6*(1 + I*Sqrt[3])*b*d - I*2^(1/3)*(I + Sqrt[3])*(-2*c^3 + 9*b*c*d - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2])^(2/3))/(2*2^(2/3)*(-2*c^3 + 9*b*c*d - 27*a*d^2 + 3*Sqrt[3]*d*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2])^(1/3)))))])/(((I*(-2*c^3 + 9*b*c*d - 3*d*(9*a*d - Sqrt[3]*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2]))^(1/3)*(4*c + (2^(1/3)*((2 + 2*I*Sqrt[3])*c^2 + 6*I*(I - Sqrt[3])*b*d + 2^(1/3)*(1 - I*Sqrt[3])*(-2*c^3 + 9*b*c*d - 3*d*(9*a*d - Sqrt[3]*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2]))^(2/3)))/(-2*c^3 + 9*b*c*d - 3*d*(9*a*d - Sqrt[3]*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2]))^(1/3) + 12*d*x))/(2*(3*I - Sqrt[3])*c^2 - 6*(3*I - Sqrt[3])*b*d + 2^(1/3)*(3*I + Sqrt[3])*(-2*c^3 + 9*b*c*d - 3*d*(9*a*d - Sqrt[3]*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2]))^(2/3)))^n*((I*(-2*c^3 + 9*b*c*d - 3*d*(9*a*d - Sqrt[3]*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2]))^(1/3)*(4*c + (2^(1/3)*((2 - 2*I*Sqrt[3])*c^2 + 6*I*(I + Sqrt[3])*b*d + 2^(1/3)*(1 + I*Sqrt[3])*(-2*c^3 + 9*b*c*d - 3*d*(9*a*d - Sqrt[3]*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2]))^(2/3)))/(-2*c^3 + 9*b*c*d - 3*d*(9*a*d - Sqrt[3]*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2]))^(1/3) + 12*d*x))/(2*(3*I + Sqrt[3])*c^2 - 6*(3*I + Sqrt[3])*b*d + 2^(1/3)*(3*I - Sqrt[3])*(-2*c^3 + 9*b*c*d - 3*d*(9*a*d - Sqrt[3]*Sqrt[(-b^2)*c^2 + 4*a*c^3 + 4*b^3*d - 18*a*b*c*d + 27*a^2*d^2]))^(2/3)))^n))} *)


(* ::Section::Closed:: *)
(*Integrands of the form u (a+b x+c x^2+d x^3+e x^4+f x^5)^p*)


{(a^5 + 5*a^4*b*x + 10*a^3*b^2*x^2 + 10*a^2*b^3*x^3 + 5*a*b^4*x^4 + b^5*x^5)^3, x, 2, (a + b*x)^16/(16*b)}
{(a^5 + 5*a^4*b*x + 10*a^3*b^2*x^2 + 10*a^2*b^3*x^3 + 5*a*b^4*x^4 + b^5*x^5)^2, x, 2, (a + b*x)^11/(11*b)}
{(a^5 + 5*a^4*b*x + 10*a^3*b^2*x^2 + 10*a^2*b^3*x^3 + 5*a*b^4*x^4 + b^5*x^5)^1, x, 1, (a + b*x)^6/(6*b), a^5*x + (5/2)*a^4*b*x^2 + (10/3)*a^3*b^2*x^3 + (5/2)*a^2*b^3*x^4 + a*b^4*x^5 + (b^5*x^6)/6}
{1/(a^5 + 5*a^4*b*x + 10*a^3*b^2*x^2 + 10*a^2*b^3*x^3 + 5*a*b^4*x^4 + b^5*x^5)^1, x, 2, -(1/(4*b*(a + b*x)^4))}
{1/(a^5 + 5*a^4*b*x + 10*a^3*b^2*x^2 + 10*a^2*b^3*x^3 + 5*a*b^4*x^4 + b^5*x^5)^2, x, 2, -(1/(9*b*(a + b*x)^9))}
{1/(a^5 + 5*a^4*b*x + 10*a^3*b^2*x^2 + 10*a^2*b^3*x^3 + 5*a*b^4*x^4 + b^5*x^5)^3, x, 2, -(1/(14*b*(a + b*x)^14))}


(* ::Section::Closed:: *)
(*Integrands of the form x^m (a+b (c+d x)^2)^p*)


{x^3/(c + (a + b*x)^2), x, 6, -((3*a*x)/b^3) + (a + b*x)^2/(2*b^4) - (a*(a^2 - 3*c)*ArcTan[(a + b*x)/Sqrt[c]])/(b^4*Sqrt[c]) + ((3*a^2 - c)*Log[c + (a + b*x)^2])/(2*b^4)}
{x^2/(c + (a + b*x)^2), x, 6, x/b^2 + ((a^2 - c)*ArcTan[(a + b*x)/Sqrt[c]])/(b^3*Sqrt[c]) - (a*Log[c + (a + b*x)^2])/b^3}
{x^1/(c + (a + b*x)^2), x, 4, -((a*ArcTan[(a + b*x)/Sqrt[c]])/(b^2*Sqrt[c])) + Log[c + (a + b*x)^2]/(2*b^2)}
{x^0/(c + (a + b*x)^2), x, 2, ArcTan[(a + b*x)/Sqrt[c]]/(b*Sqrt[c])}
{1/(x^1*(c + (a + b*x)^2)), x, 6, -((a*ArcTan[(a + b*x)/Sqrt[c]])/(Sqrt[c]*(a^2 + c))) + Log[x]/(a^2 + c) - Log[c + (a + b*x)^2]/(2*(a^2 + c))}
{1/(x^2*(c + (a + b*x)^2)), x, 7, -(1/((a^2 + c)*x)) + (b*(a^2 - c)*ArcTan[(a + b*x)/Sqrt[c]])/(Sqrt[c]*(a^2 + c)^2) - (2*a*b*Log[x])/(a^2 + c)^2 + (a*b*Log[c + (a + b*x)^2])/(a^2 + c)^2}
{1/(x^3*(c + (a + b*x)^2)), x, 7, -(1/(2*(a^2 + c)*x^2)) + (2*a*b)/((a^2 + c)^2*x) - (a*b^2*(a^2 - 3*c)*ArcTan[(a + b*x)/Sqrt[c]])/(Sqrt[c]*(a^2 + c)^3) + (b^2*(3*a^2 - c)*Log[x])/(a^2 + c)^3 - (b^2*(3*a^2 - c)*Log[c + (a + b*x)^2])/(2*(a^2 + c)^3)}


{1/(a + b*(c + d*x)^2), x, 2, ArcTan[(Sqrt[b]*(c + d*x))/Sqrt[a]]/(Sqrt[a]*Sqrt[b]*d)}
{1/(a + b*(c + d*x)^2)^2, x, 3, (c + d*x)/(2*a*d*(a + b*(c + d*x)^2)) + ArcTan[(Sqrt[b]*(c + d*x))/Sqrt[a]]/(2*a^(3/2)*Sqrt[b]*d)}
{1/(a + b*(c + d*x)^2)^3, x, 4, (c + d*x)/(4*a*d*(a + b*(c + d*x)^2)^2) + (3*(c + d*x))/(8*a^2*d*(a + b*(c + d*x)^2)) + (3*ArcTan[(Sqrt[b]*(c + d*x))/Sqrt[a]])/(8*a^(5/2)*Sqrt[b]*d)}
{1/(Sqrt[-a] + b*(c + d*x)^2), x, 2, ArcTan[(Sqrt[b]*(c + d*x))/(-a)^(1/4)]/((-a)^(1/4)*d*Sqrt[b])}

{1/(1 + (c + d*x)^2), x, 2, ArcTan[c + d*x]/d}
{1/(1 + (c + d*x)^2)^2, x, 3, (c + d*x)/(2*d*(1 + (c + d*x)^2)) + ArcTan[c + d*x]/(2*d)}
{1/(1 + (c + d*x)^2)^3, x, 4, (c + d*x)/(4*d*(1 + (c + d*x)^2)^2) + (3*(c + d*x))/(8*d*(1 + (c + d*x)^2)) + (3*ArcTan[c + d*x])/(8*d)}

{1/(1 - (c + d*x)^2), x, 2, ArcTanh[c + d*x]/d}
{1/(1 - (c + d*x)^2)^2, x, 3, (c + d*x)/(2*d*(1 - (c + d*x)^2)) + ArcTanh[c + d*x]/(2*d)}
{1/(1 - (c + d*x)^2)^3, x, 4, (c + d*x)/(4*d*(1 - (c + d*x)^2)^2) + (3*(c + d*x))/(8*d*(1 - (c + d*x)^2)) + (3*ArcTanh[c + d*x])/(8*d)}

{1/(1 - (1 + x)^2), x, 2, ArcTanh[1 + x]}
{1/(1 - (1 + x)^2)^2, x, 3, (1 + x)/(2*(1 - (1 + x)^2)) + (1/2)*ArcTanh[1 + x]}
{1/(1 - (1 + x)^2)^3, x, 4, (1 + x)/(4*(1 - (1 + x)^2)^2) + (3*(1 + x))/(8*(1 - (1 + x)^2)) + (3/8)*ArcTanh[1 + x]}


{(1 + (a + b*x)^2)^2/x, x, 3, a*(2 + a^2)*b*x + (1/2)*(2 + a^2)*(a + b*x)^2 + (1/3)*a*(a + b*x)^3 + (1/4)*(a + b*x)^4 + (1 + a^2)^2*Log[x]}
{x^2/(1 + (-1 + x)^2), x, 4, x + Log[1 + (-1 + x)^2]}


{x^2/Sqrt[1 - (1 + x)^2], x, 4, (3/2)*Sqrt[1 - (1 + x)^2] - (1/2)*x*Sqrt[1 - (1 + x)^2] + (3/2)*ArcSin[1 + x]}
{x^2/Sqrt[1 - (a + b*x)^2], x, 4, (3*a*Sqrt[1 - (a + b*x)^2])/(2*b^3) - (x*Sqrt[1 - (a + b*x)^2])/(2*b^2) + ((1 + 2*a^2)*ArcSin[a + b*x])/(2*b^3)}
{x^2/Sqrt[1 + (a + b*x)^2], x, 4, -((3*a*Sqrt[1 + (a + b*x)^2])/(2*b^3)) + (x*Sqrt[1 + (a + b*x)^2])/(2*b^2) - ((1 - 2*a^2)*ArcSinh[a + b*x])/(2*b^3)}


(* ::Section::Closed:: *)
(*Integrands of the form x^m (A+B x+C x^2+D x^3) (a+b x+c x^2+b x^3+a x^4)^p*)


{(A + B*x + C*x^2 + D*x^3)/(a + b*x + c*x^2 + b*x^3 + a*x^4), x, 11, ((4*a^2*B + b*(b - Sqrt[8*a^2 + b^2 - 4*a*c])*D - a*(A*(b - Sqrt[8*a^2 + b^2 - 4*a*c]) + b*C - Sqrt[8*a^2 + b^2 - 4*a*c]*C + 2*c*D))*ArcTan[(b - Sqrt[8*a^2 + b^2 - 4*a*c] + 4*a*x)/(Sqrt[2]*Sqrt[4*a^2 + 2*a*c - b*(b - Sqrt[8*a^2 + b^2 - 4*a*c])])])/(Sqrt[2]*a*Sqrt[8*a^2 + b^2 - 4*a*c]*Sqrt[4*a^2 + 2*a*c - b*(b - Sqrt[8*a^2 + b^2 - 4*a*c])]) - ((4*a^2*B + b*(b + Sqrt[8*a^2 + b^2 - 4*a*c])*D - a*(A*(b + Sqrt[8*a^2 + b^2 - 4*a*c]) + b*C + Sqrt[8*a^2 + b^2 - 4*a*c]*C + 2*c*D))*ArcTan[(b + Sqrt[8*a^2 + b^2 - 4*a*c] + 4*a*x)/(Sqrt[2]*Sqrt[4*a^2 + 2*a*c - b*(b + Sqrt[8*a^2 + b^2 - 4*a*c])])])/(Sqrt[2]*a*Sqrt[8*a^2 + b^2 - 4*a*c]*Sqrt[4*a^2 + 2*a*c - b*(b + Sqrt[8*a^2 + b^2 - 4*a*c])]) - ((2*a*(A - C) + (b - Sqrt[8*a^2 + b^2 - 4*a*c])*D)*Log[2*a + (b - Sqrt[8*a^2 + b^2 - 4*a*c])*x + 2*a*x^2])/(4*a*Sqrt[8*a^2 + b^2 - 4*a*c]) + ((2*a*(A - C) + (b + Sqrt[8*a^2 + b^2 - 4*a*c])*D)*Log[2*a + (b + Sqrt[8*a^2 + b^2 - 4*a*c])*x + 2*a*x^2])/(4*a*Sqrt[8*a^2 + b^2 - 4*a*c])}


{x^4*(5 + x + 3*x^2 + 2*x^3)/(2 + x + 3*x^2 + x^3 + 2*x^4), x, 14, (5*x)/4 - (3*x^2)/4 + x^3/3 + x^4/4 + (1/24)*Sqrt[5/3]*ArcTan[(1 - 4*x)/Sqrt[15]] - (10*ArcTan[(1 + 2*x)/Sqrt[3]])/(3*Sqrt[3]) + (1/3)*Log[1 + x + x^2] - (13/48)*Log[2 - x + 2*x^2]}
{x^3*(5 + x + 3*x^2 + 2*x^3)/(2 + x + 3*x^2 + x^3 + 2*x^4), x, 14, -((3*x)/2) + x^2/2 + x^3/3 + (5/12)*Sqrt[5/3]*ArcTan[(1 - 4*x)/Sqrt[15]] + (8*ArcTan[(1 + 2*x)/Sqrt[3]])/(3*Sqrt[3]) + (2/3)*Log[1 + x + x^2] - (1/24)*Log[2 - x + 2*x^2]}
{x^2*(5 + x + 3*x^2 + 2*x^3)/(2 + x + 3*x^2 + x^3 + 2*x^4), x, 14, x + x^2/2 + (1/6)*Sqrt[5/3]*ArcTan[(1 - 4*x)/Sqrt[15]] + (2*ArcTan[(1 + 2*x)/Sqrt[3]])/(3*Sqrt[3]) - Log[1 + x + x^2] + (1/4)*Log[2 - x + 2*x^2]}
{x^1*(5 + x + 3*x^2 + 2*x^3)/(2 + x + 3*x^2 + x^3 + 2*x^4), x, 14, x - (1/3)*Sqrt[5/3]*ArcTan[(1 - 4*x)/Sqrt[15]] - (10*ArcTan[(1 + 2*x)/Sqrt[3]])/(3*Sqrt[3]) + (1/3)*Log[1 + x + x^2] + (1/6)*Log[2 - x + 2*x^2]}
{x^0*(5 + x + 3*x^2 + 2*x^3)/(2 + x + 3*x^2 + x^3 + 2*x^4), x, 12, (-(1/3))*Sqrt[5/3]*ArcTan[(1 - 4*x)/Sqrt[15]] + (8*ArcTan[(1 + 2*x)/Sqrt[3]])/(3*Sqrt[3]) + (2/3)*Log[1 + x + x^2] - (1/6)*Log[2 - x + 2*x^2]}
{(5 + x + 3*x^2 + 2*x^3)/(x^1*(2 + x + 3*x^2 + x^3 + 2*x^4)), x, 12, (1/6)*Sqrt[5/3]*ArcTan[(1 - 4*x)/Sqrt[15]] + (2*ArcTan[(1 + 2*x)/Sqrt[3]])/(3*Sqrt[3]) + (5*Log[x])/2 - Log[1 + x + x^2] - (1/4)*Log[2 - x + 2*x^2]}
{(5 + x + 3*x^2 + 2*x^3)/(x^2*(2 + x + 3*x^2 + x^3 + 2*x^4)), x, 12, -(5/(2*x)) + (5/12)*Sqrt[5/3]*ArcTan[(1 - 4*x)/Sqrt[15]] - (10*ArcTan[(1 + 2*x)/Sqrt[3]])/(3*Sqrt[3]) - (3*Log[x])/4 + (1/3)*Log[1 + x + x^2] + (1/24)*Log[2 - x + 2*x^2]}
{(5 + x + 3*x^2 + 2*x^3)/(x^3*(2 + x + 3*x^2 + x^3 + 2*x^4)), x, 12, -(5/(4*x^2)) + 3/(4*x) + (1/24)*Sqrt[5/3]*ArcTan[(1 - 4*x)/Sqrt[15]] + (8*ArcTan[(1 + 2*x)/Sqrt[3]])/(3*Sqrt[3]) - (15*Log[x])/8 + (2/3)*Log[1 + x + x^2] + (13/48)*Log[2 - x + 2*x^2]}


{x^3*(5 + x + 3*x^2 + 2*x^3)/(2 + x + 5*x^2 + x^3 + 2*x^4), x, 15, (-(1/28))*(35 - 9*I*Sqrt[7])*x - (1/28)*(35 + 9*I*Sqrt[7])*x + (1/28)*(7 - 5*I*Sqrt[7])*x^2 + (1/28)*(7 + 5*I*Sqrt[7])*x^2 + (1/42)*(7 - 5*I*Sqrt[7])*x^3 + (1/42)*(7 + 5*I*Sqrt[7])*x^3 + (11*(9*I + 5*Sqrt[7])*ArcTan[(1 - I*Sqrt[7] + 8*x)/Sqrt[2*(35 + I*Sqrt[7])]])/(4*Sqrt[14*(35 + I*Sqrt[7])]) - (11*(9*I - 5*Sqrt[7])*ArcTan[(1 + I*Sqrt[7] + 8*x)/Sqrt[2*(35 - I*Sqrt[7])]])/(4*Sqrt[14*(35 - I*Sqrt[7])]) + (3/112)*(7 - 11*I*Sqrt[7])*Log[4 + (1 - I*Sqrt[7])*x + 4*x^2] + (3/112)*(7 + 11*I*Sqrt[7])*Log[4 + (1 + I*Sqrt[7])*x + 4*x^2]}
{x^2*(5 + x + 3*x^2 + 2*x^3)/(2 + x + 5*x^2 + x^3 + 2*x^4), x, 15, (1/14)*(7 - 5*I*Sqrt[7])*x + (1/14)*(7 + 5*I*Sqrt[7])*x + (1/28)*(7 - 5*I*Sqrt[7])*x^2 + (1/28)*(7 + 5*I*Sqrt[7])*x^2 - ((53*I + Sqrt[7])*ArcTan[(1 - I*Sqrt[7] + 8*x)/Sqrt[2*(35 + I*Sqrt[7])]])/(2*Sqrt[14*(35 + I*Sqrt[7])]) + ((53*I - Sqrt[7])*ArcTan[(1 + I*Sqrt[7] + 8*x)/Sqrt[2*(35 - I*Sqrt[7])]])/(2*Sqrt[14*(35 - I*Sqrt[7])]) - (1/56)*(35 + 9*I*Sqrt[7])*Log[4 + (1 - I*Sqrt[7])*x + 4*x^2] - (1/56)*(35 - 9*I*Sqrt[7])*Log[4 + (1 + I*Sqrt[7])*x + 4*x^2]}
{x^1*(5 + x + 3*x^2 + 2*x^3)/(2 + x + 5*x^2 + x^3 + 2*x^4), x, 15, (1/14)*(7 - 5*I*Sqrt[7])*x + (1/14)*(7 + 5*I*Sqrt[7])*x - ((19*I + 7*Sqrt[7])*ArcTan[(1 - I*Sqrt[7] + 8*x)/Sqrt[2*(35 + I*Sqrt[7])]])/Sqrt[14*(35 + I*Sqrt[7])] + ((19*I - 7*Sqrt[7])*ArcTan[(1 + I*Sqrt[7] + 8*x)/Sqrt[2*(35 - I*Sqrt[7])]])/Sqrt[14*(35 - I*Sqrt[7])] + (1/28)*(7 + 5*I*Sqrt[7])*Log[4 + (1 - I*Sqrt[7])*x + 4*x^2] + (1/28)*(7 - 5*I*Sqrt[7])*Log[4 + (1 + I*Sqrt[7])*x + 4*x^2]}
{x^0*(5 + x + 3*x^2 + 2*x^3)/(2 + x + 5*x^2 + x^3 + 2*x^4), x, 11, ((19*I + 7*Sqrt[7])*ArcTan[(1 - I*Sqrt[7] + 8*x)/Sqrt[2*(35 + I*Sqrt[7])]])/Sqrt[14*(35 + I*Sqrt[7])] - ((19*I - 7*Sqrt[7])*ArcTan[(1 + I*Sqrt[7] + 8*x)/Sqrt[2*(35 - I*Sqrt[7])]])/Sqrt[14*(35 - I*Sqrt[7])] + (1/28)*(7 + 5*I*Sqrt[7])*Log[4 + (1 - I*Sqrt[7])*x + 4*x^2] + (1/28)*(7 - 5*I*Sqrt[7])*Log[4 + (1 + I*Sqrt[7])*x + 4*x^2]}
{(5 + x + 3*x^2 + 2*x^3)/(x^1*(2 + x + 5*x^2 + x^3 + 2*x^4)), x, 15, ((53*I + Sqrt[7])*ArcTan[(1 - I*Sqrt[7] + 8*x)/Sqrt[2*(35 + I*Sqrt[7])]])/(2*Sqrt[14*(35 + I*Sqrt[7])]) - ((53*I - Sqrt[7])*ArcTan[(1 + I*Sqrt[7] + 8*x)/Sqrt[2*(35 - I*Sqrt[7])]])/(2*Sqrt[14*(35 - I*Sqrt[7])]) + (1/28)*(35 - 9*I*Sqrt[7])*Log[x] + (1/28)*(35 + 9*I*Sqrt[7])*Log[x] - (1/56)*(35 + 9*I*Sqrt[7])*Log[4 + (1 - I*Sqrt[7])*x + 4*x^2] - (1/56)*(35 - 9*I*Sqrt[7])*Log[4 + (1 + I*Sqrt[7])*x + 4*x^2]}
{(5 + x + 3*x^2 + 2*x^3)/(x^2*(2 + x + 5*x^2 + x^3 + 2*x^4)), x, 15, -((35 - 9*I*Sqrt[7])/(28*x)) - (35 + 9*I*Sqrt[7])/(28*x) + (11*(9 + 5*I*Sqrt[7])*ArcTanh[(I - Sqrt[7] + 8*I*x)/Sqrt[2*(35 - I*Sqrt[7])]])/(4*Sqrt[14*(35 - I*Sqrt[7])]) - (11*(9 - 5*I*Sqrt[7])*ArcTanh[(I + Sqrt[7] + 8*I*x)/Sqrt[2*(35 + I*Sqrt[7])]])/(4*Sqrt[14*(35 + I*Sqrt[7])]) - (3/56)*(7 - 11*I*Sqrt[7])*Log[x] - (3/56)*(7 + 11*I*Sqrt[7])*Log[x] + (3/112)*(7 + 11*I*Sqrt[7])*Log[4*I + (I - Sqrt[7])*x + 4*I*x^2] + (3/112)*(7 - 11*I*Sqrt[7])*Log[4*I + (I + Sqrt[7])*x + 4*I*x^2]}
{(5 + x + 3*x^2 + 2*x^3)/(x^3*(2 + x + 5*x^2 + x^3 + 2*x^4)), x, 15, -((35 - 9*I*Sqrt[7])/(56*x^2)) - (35 + 9*I*Sqrt[7])/(56*x^2) + (3*(7 - 11*I*Sqrt[7]))/(56*x) + (3*(7 + 11*I*Sqrt[7]))/(56*x) + ((355 - 73*I*Sqrt[7])*ArcTanh[(I - Sqrt[7] + 8*I*x)/Sqrt[2*(35 - I*Sqrt[7])]])/(8*Sqrt[14*(35 - I*Sqrt[7])]) - ((355 + 73*I*Sqrt[7])*ArcTanh[(I + Sqrt[7] + 8*I*x)/Sqrt[2*(35 + I*Sqrt[7])]])/(8*Sqrt[14*(35 + I*Sqrt[7])]) - (1/16)*(35 - 9*I*Sqrt[7])*Log[x] - (1/16)*(35 + 9*I*Sqrt[7])*Log[x] + (1/32)*(35 - 9*I*Sqrt[7])*Log[4*I + (I - Sqrt[7])*x + 4*I*x^2] + (1/32)*(35 + 9*I*Sqrt[7])*Log[4*I + (I + Sqrt[7])*x + 4*I*x^2]}


(* ::Section::Closed:: *)
(*Integrands requiring partial fraction expansion*)


(* ::Subsection::Closed:: *)
(*Problems from Calculus textbooks and competitions*)


{(9 + x + 3*x^2 + x^3)/((1 + x^2)*(3 + x^2)), x, 4, 3*ArcTan[x] + (1/2)*Log[3 + x^2]}
{(3 + x + x^2 + x^3)/((1 + x^2)*(3 + x^2)), x, 4, ArcTan[x] + Log[3 + x^2]/2}
{(-4 + 6*x - x^2 + 3*x^3)/((1 + x^2)*(2 + x^2)), x, 6, -3*ArcTan[x] + Sqrt[2]*ArcTan[x/Sqrt[2]] + (3*Log[1 + x^2])/2}


(* ::Subsubsection::Closed:: *)
(*Anton Calculus, 4th Edition*)


{(1 - 3*x^4)/((-2 + x)*(1 + x^2)^2), x, 7, -((1 - 2*x)/(5*(1 + x^2))) - (46*ArcTan[x])/25 - (47/25)*Log[2 - x] - (14/25)*Log[1 + x^2]}
{(-9 - 9*x + 2*x^2)/(-9*x + x^3), x, 3, -Log[3 - x] + Log[x] + 2*Log[3 + x]}
{(1 + 2*x^2 + x^5)/(-x + x^3), x, 3, x + x^3/3 + 2*Log[1 - x] - Log[x] + Log[1 + x]}
{(3 + 2*x^2)/((-1 + x)^2*x), x, 2, 5/(1 - x) - Log[1 - x] + 3*Log[x]}
{(-1 + 2*x^2)/((-1 + 4*x)*(1 + x^2)), x, 5, (3*ArcTan[x])/17 - (7/34)*Log[1 - 4*x] + (6/17)*Log[1 + x^2]}
{(-3 + 2*x - 3*x^2 + x^3)/(1 + x^2), x, 3, -3*x + x^2/2 + (1/2)*Log[1 + x^2]}
{(x + 10*x^2 + 6*x^3 + x^4)/(10 + 6*x + x^2), x, 7, x^3/3 - 3*ArcTan[3 + x] + Log[10 + 6*x + x^2]/2}
{1/(-18 + 27*x - 7*x^2 - 3*x^3 + x^4), x, 2, (1/8)*Log[1 - x] - (1/5)*Log[2 - x] + (1/12)*Log[3 - x] - (1/120)*Log[3 + x]}
{(1 + x^3)/(-2 + x), x, 2, 4*x + x^2 + x^3/3 + 9*Log[2 - x]}


(* ::Subsubsection::Closed:: *)
(*Ayres Calculus, 1964 edition*)


{(3*x - 4*x^2 + 3*x^3)/(1 + x^2), x, 4, -4*x + (3*x^2)/2 + 4*ArcTan[x]}
{(5 + 3*x)/(1 - x - x^2 + x^3), x, 4, 4/(1 - x) + ArcTanh[x]}
{(-1 - x - x^3 + x^4)/(-x^2 + x^3), x, 3, -(1/x) + x^2/2 - 2*Log[1 - x] + 2*Log[x]}
{(2 + x + x^2 + x^3)/(2 + 3*x^2 + x^4), x, 6, ArcTan[x] + Log[2 + x^2]/2}
{(-4 + 8*x - 4*x^2 + 4*x^3 - x^4 + x^5)/(2 + x^2)^3, x, 5, -(1/(2 + x^2)^2) - ArcTan[x/Sqrt[2]]/Sqrt[2] + (1/2)*Log[2 + x^2], x^2/(2*(2 + x^2)^2) + x^2/(4*(2 + x^2)) - ArcTan[x/Sqrt[2]]/Sqrt[2] + (1/2)*Log[2 + x^2]}
{(-1 - 3*x + x^2)/(-2*x + x^2 + x^3), x, 3, -Log[1 - x] + Log[x]/2 + (3/2)*Log[2 + x]}
{(3 - x + 3*x^2 - 2*x^3 + x^4)/(3*x - 2*x^2 + x^3), x, 6, x^2/2 + Log[x] - (1/2)*Log[3 - 2*x + x^2]}
{(-1 + x + x^3)/(1 + x^2)^2, x, 4, -(x/(2*(1 + x^2))) - ArcTan[x]/2 + (1/2)*Log[1 + x^2]}
{(1 + 2*x - x^2 + 8*x^3 + x^4)/((x + x^2)*(1 + x^3)), x, 8, -(3/(1 + x)) - (2*ArcTan[(1 - 2*x)/Sqrt[3]])/Sqrt[3] + Log[x] - 2*Log[1 + x] + Log[1 - x + x^2]}
{(15 - 5*x + x^2 + x^3)/((5 + x^2)*(3 + 2*x + x^2)), x, 8, (-Sqrt[5])*ArcTan[x/Sqrt[5]] + (5*ArcTan[(1 + x)/Sqrt[2]])/Sqrt[2] + (1/2)*Log[3 + 2*x + x^2]}
{(-3 + 25*x + 23*x^2 + 32*x^3 + 15*x^4 + 7*x^5 + x^6)/((1 + x^2)^2*(2 + x + x^2)^2), x, 8, -3/(1 + x^2) + (2 + x + x^2)^(-1) + Log[1 + x^2] - Log[2 + x + x^2]}


(* ::Subsubsection::Closed:: *)
(*Edwards and Penney Calculus*)


{1/((1 + x^2)*(4 + x^2)), x, 3, (-(1/6))*ArcTan[x/2] + ArcTan[x]/3}
{(a + b*x^3)/(1 + x^2), x, 5, (b*x^2)/2 + a*ArcTan[x] - (1/2)*b*Log[1 + x^2]}
{(x + x^2)/((4 + x)*(-4 + x^2)), x, 4, (-(1/2))*ArcTanh[x/2] + Log[4 + x]}
{(4 + x^2)/((1 + x^2)*(2 + x^2)), x, 3, 3*ArcTan[x] - Sqrt[2]*ArcTan[x/Sqrt[2]]}
{(5 - 4*x + 3*x^2 + x^4)/((-1 + x)^2*(1 + x^2)), x, 5, 5/(2*(1 - x)) + x + 2*ArcTan[x] + (1/2)*Log[1 - x] + (3/4)*Log[1 + x^2]}
{(1 + x^4)/(2 + x^2), x, 3, -2*x + x^3/3 + (5*ArcTan[x/Sqrt[2]])/Sqrt[2]}
{(2 + 2*x + x^4)/(x^4 + x^5), x, 3, -2/(3*x^3) + Log[1 + x]}
{(-1 - 5*x + 2*x^2)/(2 - x - 2*x^2 + x^3), x, 2, 2*Log[1 - x] - Log[2 - x] + Log[1 + x]}
{(2 + x + x^3)/(1 + 2*x^2 + x^4), x, 5, x/(1 + x^2) + ArcTan[x] + (1/2)*Log[1 + x^2]}
{(1 + 2*x + x^2 + x^3)/(1 + 2*x^2 + x^4), x, 5, -(1/(2*(1 + x^2))) + ArcTan[x] + (1/2)*Log[1 + x^2], x^2/(2*(1 + x^2)) + ArcTan[x] + (1/2)*Log[1 + x^2]}
{(3 + 4*x)/((1 + x^2)*(2 + x^2)), x, 8, 3*ArcTan[x] - (3*ArcTan[x/Sqrt[2]])/Sqrt[2] + 2*Log[1 + x^2] - 2*Log[2 + x^2]}
{(2 + x)/((1 + x^2)*(4 + x^2)), x, 8, (-(1/3))*ArcTan[x/2] + (2*ArcTan[x])/3 + (1/6)*Log[1 + x^2] - (1/6)*Log[4 + x^2]}


(* ::Subsubsection::Closed:: *)
(*Grossman Calculus*)


{(2 - x + x^3)/(-7 - 6*x + x^2), x, 5, 6*x + x^2/2 + (169/4)*Log[7 - x] - (1/4)*Log[1 + x]}
{(-1 + x^5)/(-1 + x^2), x, 3, x^2/2 + x^4/4 + Log[1 + x]}
{(5 + 2*x - x^2 + x^3)/(1 + x + x^2), x, 8, -2*x + x^2/2 + (11*ArcTan[(1 + 2*x)/Sqrt[3]])/Sqrt[3] + (3/2)*Log[1 + x + x^2]}
{(-3 + x - 2*x^3 + x^4)/(10 - 8*x + 2*x^2), x, 9, (3*x)/2 + x^2/2 + x^3/6 + 6*ArcTan[2 - x] + (3/4)*Log[5 - 4*x + x^2]}
{(1 + 2*x + 3*x^2 + x^3)/((-3 + x)*(-2 + x)*(-1 + x)), x, 2, x + (7/2)*Log[1 - x] - 25*Log[2 - x] + (61/2)*Log[3 - x]}
{(2 - 7*x + x^2 - x^3 + x^4)/(-24 - 14*x + x^2 + x^3), x, 4, -2*x + x^2/2 + (13/3)*Log[4 - x] - (22/3)*Log[2 + x] + 20*Log[3 + x]}
{(2 + x^2)/((-1 + x)^2*x*(1 + x)), x, 2, 3/(2*(1 - x)) - (5/4)*Log[1 - x] + 2*Log[x] - (3/4)*Log[1 + x]}
{(3 + x^2 + x^3)/(2 + x^2)^2, x, 4, (4 + x)/(4*(2 + x^2)) + (5*ArcTan[x/Sqrt[2]])/(4*Sqrt[2]) + (1/2)*Log[2 + x^2], ((1 - 2*x)*x)/(4*(2 + x^2)) + (5*ArcTan[x/Sqrt[2]])/(4*Sqrt[2]) + (1/2)*Log[2 + x^2]}
{(-35 + 70*x - 4*x^2 + 2*x^3)/((26 - 10*x + x^2)*(17 - 2*x + x^2)), x, 12, -((15033*ArcTan[5 - x])/1025) - (4607*ArcTan[(1/4)*(-1 + x)])/4100 + (1003*Log[26 - 10*x + x^2])/1025 + (22*Log[17 - 2*x + x^2])/1025}
{(2 + x^2)/((-5 + x)*(-3 + x)*(4 + x)), x, 2, (-(11/14))*Log[3 - x] + (3/2)*Log[5 - x] + (2/7)*Log[4 + x]}
{x^4/((-1 + x)*(2 + x^2)), x, 5, x + x^2/2 - (2/3)*Sqrt[2]*ArcTan[x/Sqrt[2]] + (1/3)*Log[1 - x] - (2/3)*Log[2 + x^2]}


(* ::Subsubsection::Closed:: *)
(*Spivak Calculus*)


{(-1 + 7*x + 2*x^2)/(-1 - x + x^2 + x^3), x, 2, -3/(1 + x) + 2*Log[1 - x]}
{(1 + 2*x)/(-1 + 3*x - 3*x^2 + x^3), x, 2, -((1 + 2*x)^2/(6*(1 - x)^2))}
{(5 - 5*x + 7*x^2 + x^3)/((-1 + x)^2*(1 + x)^3), x, 2, (1 - x)^(-1) - 2/(1 + x)^2}
{(1 + 3*x + 3*x^2)/(1 + 2*x + 2*x^2 + x^3), x, 7, (-2*ArcTan[(1 + 2*x)/Sqrt[3]])/Sqrt[3] + Log[1 + x] + Log[1 + x + x^2]}


(* ::Subsubsection::Closed:: *)
(*Stewart Calculus*)


{(-1 + 2*x + x^2)/(-2*x + 3*x^2 + 2*x^3), x, 3, (1/10)*Log[1 - 2*x] + Log[x]/2 - (1/10)*Log[2 + x]}
{(1 + 4*x - 2*x^2 + x^4)/(1 - x - x^2 + x^3), x, 6, 2/(1 - x) + x + x^2/2 - 2*ArcTanh[x]}
{(4 - x + 2*x^2)/(4*x + x^3), x, 6, (-(1/2))*ArcTan[x/2] + Log[x] + (1/2)*Log[4 + x^2]}
{(1 + x^2 + x^3)/((-1 + x)*x*(1 + x^2)^3*(1 + x + x^2)), x, 15, (1 + x)/(8*(1 + x^2)^2) - (3*(1 - x))/(8*(1 + x^2)) + (3*x)/(16*(1 + x^2)) + (7*ArcTan[x])/16 - ArcTan[(1 + 2*x)/Sqrt[3]]/Sqrt[3] + (1/8)*Log[1 - x] - Log[x] + (15/16)*Log[1 + x^2] - (1/2)*Log[1 + x + x^2]}
{(1 - 3*x + 2*x^2 - x^3)/(1 + x^2)^2, x, 4, (2 - x)/(2*(1 + x^2)) + (3*ArcTan[x])/2 - (1/2)*Log[1 + x^2], -((x*(1 + 2*x))/(2*(1 + x^2))) + (3*ArcTan[x])/2 - (1/2)*Log[1 + x^2]}
{(1 - 3*x + 2*x^2 - x^3)/(x*(1 + x^2)^2), x, 6, -((1 + 2*x)/(2*(1 + x^2))) - 2*ArcTan[x] + Log[x] - (1/2)*Log[1 + x^2], -(((2 - x)*x)/(2*(1 + x^2))) - 2*ArcTan[x] + Log[x] - (1/2)*Log[1 + x^2]}
{(1 - x - x^2 + x^3 + x^4)/(-x + x^3), x, 4, x + x^2/2 - Log[x] + (1/2)*Log[1 - x^2]}
{(2 - 4*x^2 + x^3)/((1 + x^2)*(2 + x^2)), x, 8, 6*ArcTan[x] - 5*Sqrt[2]*ArcTan[x/Sqrt[2]] - Log[1 + x^2]/2 + Log[2 + x^2]}
{(1 + x^2 + x^4)/((1 + x^2)*(4 + x^2)^2), x, 6, -((13*x)/(24*(4 + x^2))) + (25/144)*ArcTan[x/2] + ArcTan[x]/9}
{(1 + x^2 + x^3)/(2*x^2 + x^3 + x^4), x, 8, -(1/(2*x)) + ArcTan[(1 + 2*x)/Sqrt[7]]/(4*Sqrt[7]) - Log[x]/4 + (5/8)*Log[2 + x + x^2]}
{(1 - 12*x + x^2 + x^3)/(-12 + x + x^2), x, 5, x^2/2 - (2/7)*ArcTanh[(1/7)*(1 + 2*x)], x^2/2 + (1/7)*Log[3 - x] - (1/7)*Log[4 + x]}
{(-3 + 5*x + 6*x^2)/(-3*x + 2*x^2 + x^3), x, 3, 2*Log[1 - x] + Log[x] + 3*Log[3 + x]}
{(-2 + 3*x + 5*x^2)/(2*x^2 + x^3), x, 3, x^(-1) + 2*Log[x] + 3*Log[2 + x]}
{(18 - 2*x - 4*x^2)/(-6 + x + 4*x^2 + x^3), x, 2, Log[1 - x] - 2*Log[2 + x] - 3*Log[3 + x]}
{(1 + x - 2*x^2 + x^3)/(4 + 5*x^2 + x^4), x, 7, (-(3/2))*ArcTan[x/2] + ArcTan[x] + (1/2)*Log[4 + x^2]}
{(-32 + 5*x - 27*x^2 + 4*x^3)/(-70 - 299*x - 286*x^2 + 50*x^3 - 13*x^4 + 30*x^5), x, 7, (3988*ArcTan[(1 + 2*x)/Sqrt[19]])/(13685*Sqrt[19]) - (3146*Log[7 - 3*x])/80155 - (334/323)*Log[1 + 2*x] + (4822*Log[2 + 5*x])/4879 + (11049*Log[5 + x + x^2])/260015}
{(8 - 13*x^2 - 7*x^3 + 12*x^5)/(4 - 20*x + 41*x^2 - 80*x^3 + 116*x^4 - 80*x^5 + 100*x^6), x, 8, 5828/(9075*(2 - 5*x)) - (313 + 502*x)/(1452*(1 + 2*x^2)) + (503*ArcTan[Sqrt[2]*x])/(7986*Sqrt[2]) - (59096*Log[2 - 5*x])/99825 + (2843*Log[1 + 2*x^2])/7986, 5828/(9075*(2 - 5*x)) - (313 + 502*x)/(1452*(1 + 2*x^2)) - (251*ArcTan[Sqrt[2]*x])/(726*Sqrt[2]) + (272*Sqrt[2]*ArcTan[Sqrt[2]*x])/1331 - (59096*Log[2 - 5*x])/99825 + (2843*Log[1 + 2*x^2])/7986}


(* ::Subsubsection::Closed:: *)
(*Thomas Calculus, 8th Edition*)


{(9 + x^4)/(x^2*(9 + x^2)), x, 3, -x^(-1) + x - (10*ArcTan[x/3])/3}
{(2*x + x^4)/(1 + x^2), x, 6, -x + x^3/3 + ArcTan[x] + Log[1 + x^2]}
{(-x + x^3)/((-1 + x)^2*(1 + x^2)), x, 6, ArcTan[x] + Log[1 - x]}
{(2 + 5*x + 3*x^2 + 2*x^3)/(1 + x + x^2), x, 5, x + x^2 + Log[1 + x + x^2]}
{(3 - 4*x - 5*x^2 + 3*x^3)/(x^3*(-1 + x + x^2)), x, 5, 3/(2*x^2) - 1/x + 3*Log[x] - (1/10)*(15 - Sqrt[5])*Log[1 - Sqrt[5] + 2*x] - (1/10)*(15 + Sqrt[5])*Log[1 + Sqrt[5] + 2*x]}
{(4 + 8*x + 5*x^2 + 2*x^3)/(2 + 2*x + x^2)^2, x, 5, -(1/(2 + 2*x + x^2)) - ArcTan[1 + x] + Log[2 + 2*x + x^2], (x*(2 + x))/(2*(2 + 2*x + x^2)) - ArcTan[1 + x] + Log[2 + 2*x + x^2]}
{((-1 + x)^4*x^4)/(1 + x^2), x, 3, 4*x - (4*x^3)/3 + x^5 - (2*x^6)/3 + x^7/7 - 4*ArcTan[x]}
{(-20*x + 4*x^2)/(9 - 10*x^2 + x^4), x, -10, Log[1 - x] - (1/2)*Log[3 - x] + (3/2)*Log[1 + x] - 2*Log[3 + x]}
{(-1 + x + 4*x^3)/((-1 + x)*x^2*(1 + x^2)), x, 5, -x^(-1) + ArcTan[x] + 2*Log[1 - x] - Log[1 + x^2]}

{(1 - 3*x + 2*x^2 - 4*x^3 + x^4)/(1 + x^2)^3, x, 3, -((3 + 4*x^2)^2/(4*(1 + x^2)^2)) + ArcTan[x], x^2/(4*(1 + x^2)^2) + 7/(4*(1 + x^2)) + ArcTan[x]}
{(1 - 3*x + 2*x^2 - 4*x^3 + x^4)/(1 + 3*x^2 + 3*x^4 + x^6), x, 4, -(1/(4*(1 + x^2)^2)) + 2/(1 + x^2) + ArcTan[x], x^2/(4*(1 + x^2)^2) + 7/(4*(1 + x^2)) + ArcTan[x]}


(* ::Subsubsection::Closed:: *)
(*North Texas University Integration Competition*)


{(1 + x + 2*x^2 + 2*x^3)/(x^2 + x^3 + x^4), x, 5, -x^(-1) + Log[1 + x + x^2]}


(* ::Subsection::Closed:: *)
(*Miscellaneous problems*)


{1/((4 - 4*x + x^2)*(5 - 4*x + x^2)), x, 4, 1/(2 - x) + ArcTan[2 - x]}

{(-3 + x + x^2)/((-3 + x)*x^2), x, 2, -(1/x) + Log[3 - x]}
{(1 + x + 4*x^2)/(x + 4*x^3), x, 4, ArcTan[2*x]/2 + Log[x]}
{(1 - x + 3*x^2)/(-x^2 + x^3), x, 3, 1/x + 3*Log[1 - x]}
{(4 + 3*x + x^2)/(x + x^2), x, 3, x + 4*Log[x] - 2*Log[1 + x]}
{(4 + x + 3*x^2)/(x + x^3), x, 6, ArcTan[x] + 4*Log[x] - Log[1 + x^2]/2}

{(7 - 4*x + 8*x^2)/((1 + 4*x)*(1 + x^2)), x, 3, -ArcTan[x] + 2*Log[1 + 4*x]}
{x^2/((-1 + x)*(1 + 2*x + x^2)), x, 3, 1/(2*(1 + x)) + (1/4)*Log[1 - x] + (3/4)*Log[1 + x]}
{(-4 + 3*x + x^2)/((-1 + 2*x)^2*(3 + 2*x)), x, 2, -(9/(32*(1 - 2*x))) + (41/128)*Log[1 - 2*x] - (25/128)*Log[3 + 2*x]}
{(5 - 4*x + 3*x^2)/((-1 + x)*(1 + x^2)), x, 5, -3*ArcTan[x] + 2*Log[1 - x] + (1/2)*Log[1 + x^2]}
{(-1 - 2*x + x^2)/((-1 + x)^2*(1 + x^2)), x, 5, 1/(-1 + x) + ArcTan[x] + Log[1 - x] - (1/2)*Log[1 + x^2]}
{(5 + x^3)/((10 - 6*x + x^2)*(1/2 - x + x^2)), x, 12, (-(261/221))*ArcTan[1 - 2*x] - (1026/221)*ArcTan[3 - x] + (56/221)*Log[10 - 6*x + x^2] + (109/442)*Log[1 - 2*x + 2*x^2]}

{(4 + 3*x + x^2)/((-3 + x)*(-2 + x)*(-1 + x)), x, 2, 4*Log[1 - x] - 14*Log[2 - x] + 11*Log[3 - x]}
{(1 + 16*x)/((5 + x)^2*(-3 + 2*x)*(1 + x + x^2)), x, 7, -(79/(273*(5 + x))) + (451*ArcTan[(1 + 2*x)/Sqrt[3]])/(2793*Sqrt[3]) + (200*Log[3 - 2*x])/3211 + (2731*Log[5 + x])/24843 - (481*Log[1 + x + x^2])/5586}


{(-1 + x^3)/(1 + x + x^2), x, 2, -x + x^2/2}
{(-3 + x^3)/(-7 - 6*x + x^2), x, 5, 6*x + x^2/2 + (85/2)*Log[7 - x] + (1/2)*Log[1 + x]}

{(1 + x^3)/(13 + 4*x + x^2)^2, x, 4, (67 + 47*x)/(18*(13 + 4*x + x^2)) - (61/54)*ArcTan[(2 + x)/3] + (1/2)*Log[13 + 4*x + x^2]}


{(-32 + 36*x - 42*x^2 + 21*x^3 - 10*x^4 + 3*x^5)/(x*(1 + x^2)*(4 + x^2)^2), x, 7, (4 + x^2)^(-1) + ArcTan[x/2]/2 + 2*ArcTan[x] - 2*Log[x] + Log[4 + x^2]}


{(-1 + x^4 + 7*x^5 + x^9)/(-7 + 6*x^4 + x^8), x, 19, x^2/2 - ArcTan[1 - (Sqrt[2]*x)/7^(1/4)]/(2*Sqrt[2]*7^(3/4)) + ArcTan[1 + (Sqrt[2]*x)/7^(1/4)]/(2*Sqrt[2]*7^(3/4)) - ArcTanh[x^2]/2 - Log[Sqrt[7] - Sqrt[2]*7^(1/4)*x + x^2]/(4*Sqrt[2]*7^(3/4)) + Log[Sqrt[7] + Sqrt[2]*7^(1/4)*x + x^2]/(4*Sqrt[2]*7^(3/4))}
{(1 + x^3 + x^6)/(x + x^5), x, 20, x^2/2 - ArcTan[x^2]/2 - ArcTan[1 - Sqrt[2]*x]/(2*Sqrt[2]) + ArcTan[1 + Sqrt[2]*x]/(2*Sqrt[2]) + Log[x] + Log[1 - Sqrt[2]*x + x^2]/(4*Sqrt[2]) - Log[1 + Sqrt[2]*x + x^2]/(4*Sqrt[2]) - (1/4)*Log[1 + x^4]}


(* Note: This test problem formerly caused stack overflow because the degree of the polynomial 
	was not properly reduced by the Ostrogradskiy-Hermite method code. *)
(* {(a + 2*b*x - a*x^2)^4/(-1 + x^2)^5, x, 14, -((4*a*b*(3*a^2 - 2*b^2))/(3*(1 - x^2)^4)) + (11*a^4*x)/(5*(1 - x^2)^4) - (48*a^2*b^2*x)/(5*(1 - x^2)^4) + (6*b^4*x)/(5*(1 - x^2)^4) + (4*a*b*(9*a^2 - 8*b^2)*x^2)/(3*(1 - x^2)^4) - ((73*a^4 - 264*a^2*b^2 + 48*b^4)*x^3)/(15*(1 - x^2)^4) - (4*a*b*(3*a^2 - 2*b^2)*x^4)/(1 - x^2)^4 + (a^2*(11*a^2 - 24*b^2)*x^5)/(3*(1 - x^2)^4) + (4*a^3*b*x^6)/(1 - x^2)^4 - (a^4*x^7)/(1 - x^2)^4 - ((8*a^4 - 24*a^2*b^2 + 3*b^4)*x)/(15*(1 - x^2)^3) - ((8*a^4 - 24*a^2*b^2 + 3*b^4)*x)/(12*(1 - x^2)^2) - ((8*a^4 - 24*a^2*b^2 + 3*b^4)*x)/(8*(1 - x^2)) - (1/8)*(8*a^4 - 24*a^2*b^2 + 3*b^4)*ArcTanh[x]} *)


{(1 + x^2)/(-x + x^2), x, 3, x + 2*Log[1 - x] - Log[x]}

{(1 + x^3)/(-x + x^3), x, 4, x + Log[1 - x] - Log[x]}
{(1 + x^3)/(-x^2 + x^3), x, 3, x^(-1) + x + 2*Log[1 - x] - Log[x]}
{(-1 + x^5)/(-x + x^3), x, 4, x + x^3/3 + Log[x] - Log[1 + x]}
{(1 + x^4)/(x^3 + x^5), x, 4, -1/(2*x^2) - Log[x] + Log[1 + x^2]}


(* Integrands of the form (a+b*x^m)/(c*x^n+d*x^p+e*x^q) where m, n, p and q are integers *)
{(1 + x^2)/(x + 2*x^2 + x^3), x, 4, 2/(1 + x) + Log[x]}
{(1 + x^5)/(-10*x - 3*x^2 + x^3), x, 3, 19*x + (3*x^2)/2 + x^3/3 + (3126*Log[5 - x])/35 - Log[x]/10 - (31*Log[2 + x])/14}


{(15 - 5*x + x^2 + x^3)/((5 + x^2)*(3 + 2*x + x^2)), x, 8, (-Sqrt[5])*ArcTan[x/Sqrt[5]] + (5*ArcTan[(1 + x)/Sqrt[2]])/Sqrt[2] + (1/2)*Log[3 + 2*x + x^2]}

{1/((1 + x^2)*(3 + 10*x/(1 + x^2))), x, 4, (-(1/8))*Log[3 + x] + (1/8)*Log[1 + 3*x]}


(* Integrands of the form x^m/(a*x^n+b*x^p+c*x^q) where m, n, p and q are integers *)
(* In some of the following examples gcd cancellation should occur without also partial fraction 
	expansion, since that will result in unnecessary expansion. *)
{x^3/(13 + 2/x + 15*x), x, 6, (139*x)/3375 - (13*x^2)/450 + x^3/45 - (16/567)*Log[2 + 3*x] + Log[1 + 5*x]/4375}
{x^2/(13 + 2/x + 15*x), x, 6, -((13*x)/225) + x^2/30 + (8/189)*Log[2 + 3*x] - (1/875)*Log[1 + 5*x]}
{x/(13 + 2/x + 15*x), x, 5, x/15 - (4/63)*Log[2 + 3*x] + (1/175)*Log[1 + 5*x]}
{1/(13 + 2/x + 15*x), x, 4, (2/21)*Log[2 + 3*x] - (1/35)*Log[1 + 5*x]}
{1/(x*(13 + 2/x + 15*x)), x, 4, (-(1/7))*Log[2 + 3*x] + (1/7)*Log[1 + 5*x]}
{1/(x^2*(13 + 2/x + 15*x)), x, 6, Log[x]/2 + (3/14)*Log[2 + 3*x] - (5/7)*Log[1 + 5*x]}
{1/(x^3*(13 + 2/x + 15*x)), x, 7, -(1/(2*x)) - (13*Log[x])/4 - (9/28)*Log[2 + 3*x] + (25/7)*Log[1 + 5*x]}
{1/(x^4*(13 + 2/x + 15*x)), x, 4, -(1/(4*x^2)) + 13/(4*x) + (139*Log[x])/8 + (27/56)*Log[2 + 3*x] - (125/7)*Log[1 + 5*x]}
{1/(x^5*(13 + 2/x + 15*x)), x, 4, -(1/(6*x^3)) + 13/(8*x^2) - 139/(8*x) - (1417*Log[x])/16 - (81/112)*Log[2 + 3*x] + (625/7)*Log[1 + 5*x]}


{(1 - x^2)/(a + b*(1 - x^2)^4), x, 10, ArcTan[(b^(1/8)*x)/Sqrt[I*(-a)^(1/4) - b^(1/4)]]/(4*Sqrt[-a]*Sqrt[I*(-a)^(1/4) - b^(1/4)]*b^(3/8)) - ArcTan[(b^(1/8)*x)/Sqrt[(-a)^(1/4) - b^(1/4)]]/(4*Sqrt[-a]*Sqrt[(-a)^(1/4) - b^(1/4)]*b^(3/8)) - ArcTanh[(b^(1/8)*x)/Sqrt[I*(-a)^(1/4) + b^(1/4)]]/(4*Sqrt[-a]*Sqrt[I*(-a)^(1/4) + b^(1/4)]*b^(3/8)) + ArcTanh[(b^(1/8)*x)/Sqrt[(-a)^(1/4) + b^(1/4)]]/(4*Sqrt[-a]*Sqrt[(-a)^(1/4) + b^(1/4)]*b^(3/8))}
{(1 - x^2)/(a + b*(-1 + x^2)^4), x, 11, ArcTan[(b^(1/8)*x)/Sqrt[I*(-a)^(1/4) - b^(1/4)]]/(4*Sqrt[-a]*Sqrt[I*(-a)^(1/4) - b^(1/4)]*b^(3/8)) - ArcTan[(b^(1/8)*x)/Sqrt[(-a)^(1/4) - b^(1/4)]]/(4*Sqrt[-a]*Sqrt[(-a)^(1/4) - b^(1/4)]*b^(3/8)) - ArcTanh[(b^(1/8)*x)/Sqrt[I*(-a)^(1/4) + b^(1/4)]]/(4*Sqrt[-a]*Sqrt[I*(-a)^(1/4) + b^(1/4)]*b^(3/8)) + ArcTanh[(b^(1/8)*x)/Sqrt[(-a)^(1/4) + b^(1/4)]]/(4*Sqrt[-a]*Sqrt[(-a)^(1/4) + b^(1/4)]*b^(3/8))}


(* ::Section::Closed:: *)
(*Integrands requiring the Ostrogradskiy-Hermite method*)


{(-1 + 4*x^5)/(1 + x + x^5)^2, x, 1, -(x/(1 + x + x^5))}
{(b*c - a*d - 2*a*e*x - b*e*x^2 - 3*a*f*x^2 - 2*b*f*x^3)/(c + d*x + e*x^2 + f*x^3)^2, x, 4, a/(c + d*x + e*x^2 + f*x^3) + (b*x)/(c + d*x + e*x^2 + f*x^3)}
{(9 - 40*x - 18*x^2 + 174*x^4 + 24*x^5 + 26*x^6 - 39*x^8)/(3 + 2*x^2 + x^4)^3, x, 3, -((2*(-1 + 18*x + 2*x^2 + 13*x^3))/(3 + 2*x^2 + x^4)^2) + (13*x)/(3 + 2*x^2 + x^4), -((2*x*(54 + 8*x + 39*x^2 + x^3))/(3*(3 + 2*x^2 + x^4)^2)) + (x*(117 - 4*x - 2*x^3))/(9*(3 + 2*x^2 + x^4))}


(* Following integrands are equal. *)
{-((15 - 36*x + 5*x^2 + 12*x^3 - 34*x^4 + 140*x^5 + 15*x^6 + 8*x^7 - 30*x^9)/(3 + x + x^4)^4), x, 6, 2/(3 + x + x^4)^3 - (3*x)/(3 + x + x^4)^3 + (5*x^2)/(3 + x + x^4)^3 + x^4/(3 + x + x^4)^3 - (5*x^6)/(3 + x + x^4)^3}
{(3*(-47 + 228*x + 120*x^2 + 19*x^3))/(3 + x + x^4)^4 + (42 - 320*x - 75*x^2 - 8*x^3)/(3 + x + x^4)^3 + (30*x)/(3 + x + x^4)^2, x, -7, (2 - 3*x + 5*x^2 + x^4 - 5*x^6)/(3 + x + x^4)^3}
{(-3 + 10*x + 4*x^3 - 30*x^5)/(3 + x + x^4)^3 - (3*(1 + 4*x^3)*(2 - 3*x + 5*x^2 + x^4 - 5*x^6))/(3 + x + x^4)^4, x, -13, (2 - 3*x + 5*x^2 + x^4 - 5*x^6)/(3 + x + x^4)^3}


(* ::Section::Closed:: *)
(*Miscellaneous rational function problems*)


(* Following pairs of integrands are equal. *)
{(-1 + x)/(1 - x + x^2), x, 5, ArcTan[(1 - 2*x)/Sqrt[3]]/Sqrt[3] + (1/2)*Log[1 - x + x^2]}
{(-1 + x^2)/(1 + x^3), x, 6, ArcTan[(1 - 2*x)/Sqrt[3]]/Sqrt[3] + (1/2)*Log[1 - x + x^2]}

{(-4 + 3*x)/(4 - 2*x + x^2), x, 5, ArcTan[(1 - x)/Sqrt[3]]/Sqrt[3] + (3/2)*Log[4 - 2*x + x^2]}
{(-8 + 2*x + 3*x^2)/(8 + x^3), x, 6, ArcTan[(1 - x)/Sqrt[3]]/Sqrt[3] + (3/2)*Log[4 - 2*x + x^2]}


{(4 + 4*x)/(x^2*(1 + x^2)), x, 5, -4/x - 4*ArcTan[x] + 4*Log[x] - 2*Log[1 + x^2]}
{(24 + 8*x)/(x*(-4 + x^2)), x, 5, 5*Log[2 - x] - 6*Log[x] + Log[2 + x]}


{(-1 + x^2)/(-2*x + x^3), x, 4, Log[x]/2 + (1/4)*Log[2 - x^2]}
{(1 + x^2)/(3*x + x^3), x, 4, Log[x]/3 + (1/3)*Log[3 + x^2]}
{(a + 3*b*x^2)/(a*x + b*x^3), x, 4, Log[x] + Log[a + b*x^2]}


{(-2 + 4*x)/(-x + x^3), x, 6, Log[1 - x] + 2*Log[x] - 3*Log[1 + x]}
{(4 + x)/(4*x + x^3), x, 6, (1/2)*ArcTan[x/2] + Log[x] - (1/2)*Log[4 + x^2]}

{(-x + 2*x^3)/(1 - x^2 + x^4), x, 3, Log[1 - x^2 + x^4]/2}

{(-3 + x)/(2*x + 3*x^2 + x^3), x, 6, -((3*Log[x])/2) + 4*Log[1 + x] - (5/2)*Log[2 + x]}
{(2 + 4*x)/(x^2 + 2*x^3 + x^4), x, 3, -(2/(x*(1 + x)))}
{(1 + x)/(-6*x + x^2 + x^3), x, 6, (3/10)*Log[2 - x] - Log[x]/6 - (2/15)*Log[3 + x]}

{(4*x^2 + x^3)/(x + x^3), x, 7, x - ArcTan[x] + 2*Log[1 + x^2]}
{(x + 2*x^3)/(x^2 + x^4)^3, x, 4, -(1/(4*x^4*(1 + x^2)^2))}
{(a*x^2 + b*x^3)/(c*x^2 + d*x^3), x, 4, (b*x)/d - ((b*c - a*d)*Log[c + d*x])/d^2}
{(x + x^2)/(-2*x - x^2 + x^3), x, 4, Log[2 - x]}


{(1 - 5*x^2)/(x^3*(1 + x^2)), x, 3, -(1/(2*x^2)) - 6*Log[x] + 3*Log[1 + x^2]}
{(2*x)/((-1 + x)*(5 + x^2)), x, 6, (1/3)*Sqrt[5]*ArcTan[x/Sqrt[5]] + (1/3)*Log[1 - x] - (1/6)*Log[5 + x^2]}
{(2 + x^2)/(2 + x), x, 2, -2*x + x^2/2 + 6*Log[2 + x]}
{1/((-3 + x)*(4 + x^2)), x, 5, (-(3/26))*ArcTan[x/2] + (1/13)*Log[3 - x] - (1/26)*Log[4 + x^2]}
{(-2 + 3*x^6)/(x*(5 + 2*x^6)), x, 3, (-2*Log[x])/5 + (19*Log[5 + 2*x^6])/60}


{(3 + 2*x)/((-2 + x)*(5 + x)), x, 2, Log[2 - x] + Log[5 + x]}
{x^4/(4 + 5*x^2 + x^4), x, 4, x - (8/3)*ArcTan[x/2] + ArcTan[x]/3}
{1/((1 + x)*(2 + x)^2*(3 + x)^3), x, 2, 1/(2 + x) + 1/(4*(3 + x)^2) + 5/(4*(3 + x)) + (1/8)*Log[1 + x] + 2*Log[2 + x] - (17/8)*Log[3 + x]}
{x/(-1 + x^2), x, 1, (1/2)*Log[1 - x^2]}
{(-1 + x^2)^(-2), x, 2, x/(2*(1 - x^2)) + ArcTanh[x]/2}
{x^2/(1 + x^2)^2, x, 2, -(x/(2*(1 + x^2))) + ArcTan[x]/2}
{1/(2 + 3*x), x, 1, Log[2 + 3*x]/3}
{1/(a^2 + x^2), x, 1, ArcTan[x/a]/a}
{1/(a + b*x^2), x, 1, ArcTan[(Sqrt[b]*x)/Sqrt[a]]/(Sqrt[a]*Sqrt[b])}
{1/(2 - x + x^2), x, 2, -((2*ArcTan[(1 - 2*x)/Sqrt[7]])/Sqrt[7])}


{x^2*(4 - x^2)^2, x, 2, (16*x^3)/3 - (8*x^5)/5 + x^7/7}
{x*(1 - x^3)^2, x, 2, x^2/2 - (2*x^5)/5 + x^8/8}
{(-4 + 5*x^2 + x^3)/x^2, x, 2, 4/x + 5*x + x^2/2}
{(-1 + x)/(3 - 4*x + 3*x^2), x, 5, ArcTan[(2 - 3*x)/Sqrt[5]]/(3*Sqrt[5]) + (1/6)*Log[3 - 4*x + 3*x^2]}


{(2 + x^3)^2, x, 2, 4*x + x^4 + x^7/7}
{(-4 + x^2)/(2 + x), x, 2, -2*x + x^2/2}
{1/((2 + x)*(1 + x^2)), x, 5, (2*ArcTan[x])/5 + (1/5)*Log[2 + x] - (1/10)*Log[1 + x^2]}
{1/((1 + x)*(1 + x^2)), x, 5, ArcTan[x]/2 + (1/2)*Log[1 + x] - (1/4)*Log[1 + x^2]}
{x/((1 + x)*(1 + x^2)), x, 5, ArcTan[x]/2 - (1/2)*Log[1 + x] + (1/4)*Log[1 + x^2]}
{(2*x + x^2)/(1 + x)^2, x, 2, (2 + x)^2/(1 + x)}
{(-10 + x^2)/(4 + 9*x^2 + 2*x^4), x, 3, ArcTan[x/2] - (3*ArcTan[Sqrt[2]*x])/Sqrt[2]}
{(31 + 5*x)/(11 - 4*x + 3*x^2), x, 5, -((103*ArcTan[(2 - 3*x)/Sqrt[29]])/(3*Sqrt[29])) + (5/6)*Log[11 - 4*x + 3*x^2]}


{(-2 + x^2 + x^3)/x^4, x, 2, 2/(3*x^3) - x^(-1) + Log[x]}
{(1 + x + x^3)/x^2, x, 2, -(1/x) + x^2/2 + Log[x]}
{(-2 + x^2)/(x*(2 + x^2)), x, 3, -Log[x] + Log[2 + x^2]}


{(-3 + x)*(-7 + 4*x^2), x, 2, 21*x - (7*x^2)/2 - 4*x^3 + x^4}
{(-2 + 7*x)^3, x, 1, (1/28)*(2 - 7*x)^4}
{(-7 + 4*x^2)/(3 + 2*x), x, 2, -3*x + x^2 + Log[3 + 2*x]}
{(1 + x)/((-1 + x)*x^2), x, 2, 1/x + 2*Log[1 - x] - 2*Log[x]}


{1/(4*x^2 + 4*x^3 + x^4), x, 4, -(1/(4*x)) - 1/(4*(2 + x)) + (1/2)*ArcTanh[1 + x], -(1/(4*x)) - 1/(4*(2 + x)) - Log[x]/4 + (1/4)*Log[2 + x]}
{(1 + x^2)/(1 + x), x, 2, -x + x^2/2 + 2*Log[1 + x]}
{(-1 + 3*x - 3*x^2 + x^3)/x^2, x, 2, 1/x - 3*x + x^2/2 + 3*Log[x]}
{((3 - Sqrt[37])/2 + x)*((3 + Sqrt[37])/2 + x), x, 2, -7*x + (3*x^2)/2 + x^3/3}


{(4 + 3*x^2 + 2*x^3)/(1 + x)^4, x, 2, -5/(3*(1 + x)^3) + 3/(1 + x) + 2*Log[1 + x]}
{x/((1 + x)^2*(1 + x^2)), x, 3, 1/(2*(1 + x)) + ArcTan[x]/2}
{(7 - 2*x + 3*x^2 - x^3 + x^4)/(2 + x), x, 2, -20*x + (9*x^2)/2 - x^3 + x^4/4 + 47*Log[2 + x]}
{(-1 + x^3)/(-1 + x), x, 2, x + x^2/2 + x^3/3}
{(2 + 2*x)/((-1 + x)^3*(1 + x^2)), x, 3, -(1/(1 - x)^2) + 1/(-1 + x) + ArcTan[x]}


{1/(b*x + c*(d + e*x)^2), x, 3, -((2*ArcTanh[(b + 2*c*d*e + 2*c*e^2*x)/(Sqrt[b]*Sqrt[b + 4*c*d*e])])/(Sqrt[b]*Sqrt[b + 4*c*d*e]))}
{1/(a + b*x + c*(d + e*x)^2), x, 3, -((2*ArcTanh[(b + 2*c*d*e + 2*c*e^2*x)/Sqrt[b^2 + 4*b*c*d*e - 4*a*c*e^2]])/Sqrt[b^2 + 4*b*c*d*e - 4*a*c*e^2])}


{x^2/(1 + (-1 + x^2)^2), x, 12, (-(1/2))*Sqrt[(1/2)*(1 + Sqrt[2])]*ArcTan[(Sqrt[2*(1 + Sqrt[2])] - 2*x)/Sqrt[2*(-1 + Sqrt[2])]] + (1/2)*Sqrt[(1/2)*(1 + Sqrt[2])]*ArcTan[(Sqrt[2*(1 + Sqrt[2])] + 2*x)/Sqrt[2*(-1 + Sqrt[2])]] + Log[Sqrt[2] - Sqrt[2*(1 + Sqrt[2])]*x + x^2]/(4*Sqrt[2*(1 + Sqrt[2])]) - Log[Sqrt[2] + Sqrt[2*(1 + Sqrt[2])]*x + x^2]/(4*Sqrt[2*(1 + Sqrt[2])])}
